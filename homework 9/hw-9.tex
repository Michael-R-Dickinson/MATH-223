\documentclass[12pt, oneside]{amsart}
\usepackage{amsmath,amsfonts, amssymb, xcolor}
\usepackage{fullpage}

\usepackage[most]{tcolorbox} % powerful colored boxes
\usepackage{xcolor}          % colors
\newtcolorbox{solution}{
  breakable,              % allow page breaks
  enhanced,               % better control of title etc.
  colback=white,          % white background
  colframe=gray,          % solid gray border
  boxrule=0.5pt,          % border thickness
  left=6pt, right=6pt, top=6pt, bottom=6pt, % padding
  title=\textbf{Solution},
  coltitle=black,
  fonttitle=\normalsize\bfseries,
  attach boxed title to top left={yshift=-2pt, xshift=4pt},
  boxed title style={
    colback=white,
    colframe=white,
    boxrule=0pt,
    sharp corners
  }
}

\newcommand{\Z}{\mathbb Z}
\newcommand{\R}{\mathbb R}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\spn}{span}
\DeclareMathOperator{\proj}{proj}
\newcommand\norm[1]{\left\lVert#1\right\rVert}

\theoremstyle{definition}
\newtheorem{prob}{Problem}

\title{Math 223 Fall 2025 - Homework 9}
\author{due November 25 at 11:59pm}
\pagenumbering{gobble}
\begin{document}
\maketitle
Each problem is worth 10 points.

\begin{prob}
  Let $V =\mathbb R^n$ with the standard inner product (the dot product). Find $\text{proj}_{U}(v)$ where
  \begin{enumerate}
    \item $n= 2$, $U = \{(x,y)\in \mathbb R^2\mid y=4x\}$, and $v = \left[
        \begin{matrix} 2\\6
      \end{matrix}\right]$.

      \begin{solution}

        From the equation we can find a single basis vector for the one-dimensional subspace $U$.

        We pick $x = 1$ and get the basis vector $u =
        \begin{bmatrix} 1 \\ 4
        \end{bmatrix}$. We can now project $v$ onto this subspace by projecting it onto its single basis vector:

        \[
          \proj_U(v) = \frac{\langle v, u \rangle}{\norm{u}^2} u = \frac{26}{17}
          \begin{bmatrix} 1 \\ 4
          \end{bmatrix} =
          \begin{bmatrix} 26/17 \\ 104/17
          \end{bmatrix}.
        \]

      \end{solution}
    \item $n=3$, $U = \{(x,y,z)\in \mathbb R^3\mid x+3y-2z=0\}$, and $v = \left[
        \begin{matrix} 2\\1\\3
      \end{matrix}\right]$.

      \begin{solution}
        The subspace $U$ is defined by the equation $x + 3y - 2z = 0$ so we can get two basis vectors for the space by picking values for $y$ and $z$ and taking the resulting solutions as vectors.

        Setting $y=1, z=0$ results in $u_1 =
        \begin{bmatrix} -3\\1\\0
        \end{bmatrix}$, and setting $y=0, z=1$ gives $u_2 =
        \begin{bmatrix} 2\\0\\1
        \end{bmatrix}$. Thus $(u_1, u_2)$ is a basis for $U$.

        These vectors are not orthogonal, so we use the Gram-Schmidt process to compute an orthonormal basis.

        \vspace{0.3cm}

        We start by normalizing $u_1$ to get our first basis vector $e_1$:
        \[
          e_1 = \frac{u_1}{\norm{u_1}}.
        \]
        \[
          \norm{u_1}^2 = 9 + 1 + 0 = 10
        \]
        \[
          e_1 = \frac{1}{\sqrt{10}}
          \begin{bmatrix} -3\\1\\0
          \end{bmatrix}.
        \]

        Next, we compute our second orthogonal vector in the basis $w_2$ by subtracting the projection of $u_2$ onto $u_1$ from $u_2$:
        \[
          w_2 = u_2 - \frac{\langle u_2, u_1 \rangle}{\norm{u_1}^2}u_1 = u_2 - \frac{-6}{10}u_1 = u_2 + \frac{3}{5}u_1.
        \]
        \[
          \langle u_2, u_1 \rangle = -6.
        \]

        We compute the final value of $w_2$:
        \[
          w_2 =
          \begin{bmatrix} 2 - 9/5 \\ 3/5 \\ 1
          \end{bmatrix} = \frac{1}{5}
          \begin{bmatrix} 1\\3\\5
          \end{bmatrix}.
        \]

        Now we normalize $w_2$:
        \[
          \norm{w_2}^2 = \frac{1}{25}(1 + 9 + 25) = \frac{35}{25} = \frac{7}{5}
        \]
        \[\norm{w_2} = \frac{\sqrt{35}}{5}\]
        \[
          e_2 = \frac{1}{\sqrt{35}}
          \begin{bmatrix} 1\\3\\5
          \end{bmatrix}.
        \]

        \vspace{0.3cm}

        As we have now orthagonalized and normalized all vectors in our basis, we have an orthonormal basis of $U$ given by $(e_1, e_2)$.

        We can now compute the projection of $v =
        \begin{bmatrix} 2\\1\\3
        \end{bmatrix}$ onto $U$ by taking its projection onto onto each orthonormal basis vector (we disregard the $\norm{e_i}^2$ denominators as they are all 1 because the basis has been normalized):
        \[
          \proj_U(v) = \langle v, e_1 \rangle e_1 + \langle v, e_2 \rangle e_2.
        \]

        We compute each inner product and substitute them into the projection formula:
        \[
          \langle v, e_1 \rangle =  \frac{-5}{\sqrt{10}} \quad \langle v, e_2 \rangle = \frac{20}{\sqrt{35}}.
        \]

        \[
          \proj_U(v) = \frac{-5}{\sqrt{10}} \cdot \frac{1}{\sqrt{10}}
          \begin{bmatrix} -3\\1\\0
          \end{bmatrix} + \frac{20}{\sqrt{35}} \cdot \frac{1}{\sqrt{35}}
          \begin{bmatrix} 1\\3\\5
          \end{bmatrix} = -\frac{1}{2}
          \begin{bmatrix} -3\\1\\0
          \end{bmatrix} + \frac{4}{7}
          \begin{bmatrix} 1\\3\\5
          \end{bmatrix} = \frac{1}{14}
          \begin{bmatrix} 29\\17\\40
          \end{bmatrix}.
        \]

        This gives our final answer:
        \[\proj_U(v) = \frac{1}{14}
          \begin{bmatrix} 29\\17\\40
        \end{bmatrix}\]

      \end{solution}

  \end{enumerate}
\end{prob}

\begin{prob}
  Let $U = \spn \left(\left[
      \begin{matrix} 1\\2\\3\\-4
    \end{matrix}\right], \left[
      \begin{matrix} -5\\4\\3\\2
  \end{matrix}\right]\right)$ be a subspace of $\mathbb R^4$. Find an orthonormal basis of $U$ and an orthonormal basis of $U^{\perp}$.
\end{prob}

\begin{solution}
  To find an orthonormal basis of $U$ we take our existing basis for $U$ and apply the Gram-Schmidt procedure. We start with $u_1$ and normalize it, then compute all remaining orthonormal vectors by subtracing the projections onto the previous vectors and normalizing.

  First we normalize $u_1$ to get our first orthonormal vector $e_1$:
  \[
    \norm{u_1}^2 = 1 + 4 + 9 + 16 = 30
  \]

  \[
    e_1 = \frac{1}{\sqrt{30}}
    \begin{bmatrix} 1\\2\\3\\-4
    \end{bmatrix}.
  \]

  Next we get an orthogonal vector $w_2$ by subtracing the component of $u_1$ from $u_2$ to orthagonalize it:

  \[
    w_2 = u_2 - \text{proj}_{u_1}(u_2)
  \]

  \[
    w_2 = u_2 - \frac{\langle u_2, u_1 \rangle}{\norm{u_1}^2} u_1 = u_2 - \frac{4}{30} u_1 = u_2 - \frac{2}{15} u_1.
  \]

  \[
    \langle u_2, u_1 \rangle = 4.
  \]

  \[
    w_2 =
    \begin{bmatrix} -5 - 2/15 \\ 4 - 4/15 \\ 3 - 6/15 \\ 2 + 8/15
    \end{bmatrix} =
    \frac{1}{15}
    \begin{bmatrix} -77 \\ 56 \\ 39 \\ 38
    \end{bmatrix}.
  \]

  Finally we normalize $w_2$ to get $e_2$:
  \[
    e_2 = \frac{w_2}{\norm{w_2}}
  \]

  \[
    \norm{w_2}^2
    = \frac{1}{225}(77^2 + 56^2 + 39^2 + 38^2)
    = \frac{802}{15}
  \]
  \[
    \norm{w_2} = \sqrt{802/15} = \frac{\sqrt{12030}}{15}
  \]

  \[
    e_2 = \frac{w_2}{\norm{w_2}} = \frac{1}{\sqrt{12030}}
    \begin{bmatrix} -77 \\ 56 \\ 39 \\ 38
    \end{bmatrix}.
  \]

  Finally, we have applied the Grahm Schmidt procedure to all vectors in our bass to obtain an orthonormal basis of $U$. Our basis is the set of vectors $(e_1, e_2)$:
  \[
    \left( \frac{1}{\sqrt{30}}
      \begin{bmatrix} 1\\2\\3\\-4
      \end{bmatrix}, \frac{1}{\sqrt{12030}}
      \begin{bmatrix} -77\\56\\39\\38
    \end{bmatrix} \right).
  \]

  \vspace{0.3cm}

  Now we find an orthonormal basis of $U^\perp$.

  By the lemma shown in lecture, we know that vectors in $U^\perp$ are in the kernel of the matrix whose rows are the basis of $U$.

  \[
    \forall v\in U^\perp \; v\in\text{ker}
    \begin{bmatrix} 1 & 2 & 3 & -4 \\ -5 & 4 & 3 & 2
    \end{bmatrix}
  \]

  Therefore, to find the basis of $U^\perp$, we will find two linearly independent vectors in $U^\perp$ by solving the equation:

  \[
    \begin{bmatrix} 1 & 2 & 3 & -4 \\ -5 & 4 & 3 & 2
    \end{bmatrix}
    \begin{bmatrix} x_1 \\ x_2 \\ x_3 \\ x_4
    \end{bmatrix} =
    \begin{bmatrix} 0 \\ 0
    \end{bmatrix}
  \]

  We pick $x_3=7$ and $x_4=0$ to get our first vector (which leads to the solutions $x_1 = -3$ and $x_2 = -9$) so $v_1 =
  \begin{bmatrix} -3 \\ -9 \\ 7 \\ 0
  \end{bmatrix}$.

  We pick $x_3 = 0$ and $x_4 = 7$ which leads to the solutions $x_1 = 10$ and $x_2 = 9$, so $v_2 =
  \begin{bmatrix} 10 \\ 9 \\ 0 \\ 7
  \end{bmatrix}$.

  By finding two independent vectors in $U^\perp$, we have a basis for $U^\perp$ - $(v_1, v_2)$:

  \[(
      \begin{bmatrix} -3 \\ -9 \\ 7 \\ 0
      \end{bmatrix},
      \begin{bmatrix} 10 \\ 9 \\ 0 \\ 7
  \end{bmatrix})\]

  We now apply the Gram-Schmidt procedure to transform this into an orthonormal basis.

  First, we normalize $v_1$:
  \[
    \norm{v_1}^2 = 9 + 81 + 49 + 0 = 139
  \]

  \[
    e_1 = \frac{1}{\sqrt{139}}
    \begin{bmatrix} -3 \\ -9 \\ 7 \\ 0
    \end{bmatrix}.
  \]

  Next, we find the second vector $w_2$ by removing the component of $v_1$ from $v_2$:

  \[
    w_2 = v_2 - \text{proj}_{v_1}(v_2) = v_2 - \frac{\langle v_2, v_1 \rangle}{\norm{v_1}^2} v_1
  \]

  \[
    \langle v_2, v_1 \rangle = -111.
  \]

  \[
    w_2 = v_2 - \frac{-111}{139} v_1 = v_2 + \frac{111}{139} v_1.
  \]

  \[
    w_2 =
    \begin{bmatrix} 10 - 333/139 \\ 9 - 999/139 \\ 777/139 \\ 7
    \end{bmatrix} = \frac{7}{139}
    \begin{bmatrix} 151 \\ 36 \\ 111 \\ 139
    \end{bmatrix}.
  \]

  Finally we normalize $w_2$ to get our second orthonormal basis vector $e_2$:
  \[
    \norm{w_2}^2 = \frac{49}{139^2}(151^2 + 36^2 + 111^2 + 139^2) = \frac{2731221}{139^2}
  \]

  \[
    \norm{w_2} = \frac{7\sqrt{55739}}{139}
  \]
  \[
    e_2 = \frac{w_2}{\norm{w_2}} = \frac{1}{\sqrt{55739}}
    \begin{bmatrix} 151 \\ 36 \\ 111 \\ 139
    \end{bmatrix}.
  \]

  Finally we have two orthonormal vectors $e_1$ and $e_2$ which form an orthonormal basis of $U^\perp$:
  \[
    \left( \frac{1}{\sqrt{139}}
      \begin{bmatrix} -3\\-9\\7\\0
      \end{bmatrix}, \frac{1}{\sqrt{55739}}
      \begin{bmatrix} 151\\36\\111\\139
    \end{bmatrix} \right).
  \]
\end{solution}

\begin{prob}
  Let $V$ be a finite dimensional inner product space.
  \begin{enumerate}

    \item Let $U\subseteq V$ a subspace with a basis $(u_1,\dots, u_k)$. Show that if we complete $(u_1,\dots, u_k)$ to a basis $(u_1,\dots, u_k, u_{k+1}, \dots, u_n)$ of $V$ and apply the Gram-Schmidt procedure to get an orthonormal basis $(v_1, \dots, v_n)$ of $V$, then $(v_1, \dots, v_k)$ is an orthonormal basis of $U$, and $(v_{k+1}, \dots, v_n)$ is an orthonormal basis of $U^{\perp}$.

      \begin{solution}
        We first show that $(v_1, \ldots, v_k)$ is an orthonormal basis of $U$.

        We know that the Grahm-Schmidt procedure is processed in order on each vector, such that each vector has removed its components of all previous vectors in the orthonormal set. Therefore, in the set we applied Grahm Schmidt to $(v_1, \ldots, v_n)$, the first $k$ vectors $(v_1, \ldots, v_k)$ are the result of applying Grahm-Schmidt to the vectors $(u_1, \ldots, u_k)$ which are the first $k$ vectors in our original set.

        We know that $(u_1, \ldots, u_k)$ is a basis of $U$, which means that is spans $U$:
        \[
          U = \spn(u_1, \ldots, u_k).
        \]

        The Grahm-Schmidt procedure preserves the span of the vectors it is applied to.
        Therefore, our resulting vectors of this procedure $(v_1, \ldots, v_k)$ still spans $U$:
        \[
          U = \spn(v_1, \ldots, v_k).
        \]

        Finally, because the Grahm-Schmidt procedure produces orthonormal vectors, we know that $(v_1, \ldots, v_k)$ are orthonormal.
        Thus as we have shown that $(v_1, \ldots, v_k)$ is an orthonormal set with $\spn(v_1, \ldots, v_k) = U$, $(v_1, \ldots, v_k)$ is an orthonormal basis of $U$.

        \vspace{0.9cm}

        Now we show that $(v_{k+1}, \ldots, v_n)$ is an orthonormal basis of $U^\perp$. We start by showing that $\spn(v_{k+1}, \ldots, v_n) \subseteq U^\perp$.

        We do this by showing that every vector in $\spn(v_{k+1}, \ldots, v_n)$ is orthogonal to every vector in $U$. Thus each vector in $\spn(v_{k+1}, \ldots, v_n)$ is in $U^\perp$.

        Consider a $u \in U$.
        Since $(v_1, \ldots, v_k)$ is a basis of $U$, we can write each $u \in U$ as a linear combination of these vectors:

        \[
          u = c_1 v_1 + \cdots + c_k v_k
        \]
        \[
          c_1, \ldots, c_k \in \mathbb{F}
        \]

        Taking the inner product of both sides with an element $v_j$ from $(v_{k+1}, \ldots, v_n)$:
        \[
          \langle v_j \mid u \rangle = \langle v_j \mid c_1 v_1 + \cdots + c_k v_k \rangle = c_1 \langle v_j \mid v_1 \rangle + \cdots + c_k \langle v_j \mid v_k \rangle.
        \]
        Since $(v_1, \ldots, v_n)$ is orthonormal, we know that each inner product is $0$ (there is no $\langle v_j \mid v_j \rangle$ term since $j > k$). With all terms equal to zero our equation simplifies to:
        \[
          \langle v_j \mid u \rangle = c_1 \cdot 0 + \cdots + c_k \cdot 0 = 0.
        \]

        As the inner product is $0$ this means that $v_j \perp u$. Since this holds for all $u \in U$, $v_j$ is perpendicular to all vectors in $U$. Therefore $v_j \in U^\perp$.

        As all vectors in $\spn(v_{k+1}, \ldots, v_n)$ are linear combinations of the vectors $v_j$, and each $v_j$ is in $U^\perp$, all vectors in $\spn(v_{k+1}, \ldots, v_n)$ are also in $U^\perp$.
        This shows that $\spn(v_{k+1}, \ldots, v_n) \subseteq U^\perp$.

        \vspace{0.3cm}

        Next, we show the reverse inclusion: $U^\perp \subseteq \spn(v_{k+1}, \ldots, v_n)$ by showing that all vectors in $U^\perp$ can be written as linear combinations of the vectors $(v_{k+1}, \ldots, v_n)$.

        Consider $w \in U^\perp$. Since $(v_1, \ldots, v_n)$ is a basis of $V$, we can write:
        \[
          w = a_1 v_1 + a_2 v_2 + \cdots + a_n v_n
        \]
        \[a_1, \ldots, a_n \in \mathbb{F}\]

        For any $i \leq k$, the vector $v_i$ is in $U$ (as we proved earlier). Since $w \in U^\perp$, we have $\langle w \mid v_i \rangle = 0$. Therefore when we take the inner product of both sides in the equation with $v_i$, the left hand side of the equation is equal to $0$. Additionally, because all vectors in $(v_1, \ldots, v_n)$ are orthonormal, all inner products on the right hand side are $0$ except for $\langle v_i \mid v_i \rangle = 1$. Thus we can simplify it as follows:
        \[
          \langle w \mid v_i \rangle = \langle a_1 v_1 + \cdots + a_n v_n \mid v_i \rangle = a_1 \langle v_1 \mid v_i \rangle + \cdots + a_n \langle v_n \mid v_i \rangle = a_i.
        \]
        Thus $a_i = 0$ for all $i \leq k$, which means
        \[
          w
          = 0 v_1 + 0 v_2 \cdots 0 v_k +  a_{k+1} v_{k+1} + \cdots + a_n v_n= a_{k+1} v_{k+1} + \cdots + a_n v_n
        \]

        Therefore $w \in \spn(v_{k+1}, \ldots, v_n)$ for all $w \in U^\perp$.

        Finally, we can conclude: \[U^\perp \subseteq \spn(v_{k+1}, \ldots, v_n)\]

        \vspace{0.3cm}

        As we have shown both inclusions, we know that $U^\perp = \spn(v_{k+1}, \ldots, v_n)$. Since $(v_{k+1}, \ldots, v_n)$ is an orthonormal set (being part of an orthonormal basis of $V$), it is linearly independent and spans $U^\perp$. Therefore $(v_{k+1}, \ldots, v_n)$ is an orthonormal basis of $U^\perp$.

        \vspace{0.3cm}

      \end{solution}

    \item Deduce that $\dim U + \dim U^{\perp} = \dim V.$
  \end{enumerate}

\end{prob}

\begin{solution}
  From part 1 we know that $(v_1, \ldots, v_k)$ is a basis of $U$ and $(v_{k+1}, \ldots, v_n)$ is a basis of $U^\perp$. Thus
  \[
    \dim U = k \quad \text{and} \quad \dim U^\perp = n - k.
  \]
  Adding these together:
  \[
    \dim U + \dim U^\perp = k + (n - k) = n = \dim V.
  \]
\end{solution}

\begin{prob}
  Let $V= \mathcal P_2(\mathbb R)$ with the inner product $\langle f,g\rangle = \int_0^1 f(x)g(x)dx$. Consider the functional $F:V\to \mathbb R$ given by $F(f) = f(0) + f'(1)$. Find $g\in \mathcal P_2(\mathbb R)$ representing $F$ in the Riesz representation theorem, i.e.\ such that $F(f) = \langle f\mid g\rangle$.
\end{prob}

\begin{solution}
  As a linear operator is uniquely defined by its operations on a basis, we can compute $F$ on the standard basis for $\mathcal P_2(\mathbb R)$ and find a function $g$ that satisfies $\langle \text{basis} \mid g \rangle = F(\text{basis})$.

  First, we compute $F$ on each basis element:
  \begin{align*}
    F(1) = 1 + 0 = 1 \\ F(x) = 0 + 1 = 1 \\ F(x^2) = 0 + 2 = 2
  \end{align*}

  To find a $g$, we can write it as a polynomial and compute its inner product with each basis vector. Then we can solve the system of equations such that each inner product produces the same values from the basis vectors as $F$.

  First, we write $g(x) = a + bx + cx^2$ and compute the inner product of $g$ with each basis vector, setting them equal to the corresponding $F$ value:

  \[
    \langle 1 \mid g \rangle = \int_0^1 (a + bx + cx^2)\,dx = a + \frac{b}{2} + \frac{c}{3} = 1.
  \]

  \[
    \langle x \mid g \rangle = \int_0^1 x(a + bx + cx^2)\,dx = \frac{a}{2} + \frac{b}{3} + \frac{c}{4} = 1.
  \]

  \[
    \langle x^2 \mid g \rangle = \int_0^1 x^2(a + bx + cx^2)\,dx = \frac{a}{3} + \frac{b}{4} + \frac{c}{5} = 2.
  \]

  This gives us a system of equations. We can simplify each equation by multiplying out the denominators:
  \begin{align*}
    6a + 3b + 2c = 6 \\
    6a + 4b + 3c = 12 \\
    20a + 15b + 12c = 120
  \end{align*}

  Finally we can solve this system of equations to get:

  \[
    a = 33 \quad
    b = -204 \quad
    c = 210
  \]

  Lastly, we can rewrite $g$ with these coefficients:
  \[
    g(x) = 33 - 204x + 210x^2.
  \]
  By solving this system for the $g$, we have found a function such that $F(f) = \langle f \mid g \rangle$ for all $f \in V$, which is the function required by the Riesz representation theorem.
\end{solution}

\noindent \textbf{Generative AI Acknowledgment}

\noindent Generative AI was used in this assignment for help with latex syntax. This includes defining the solution box that wraps answers. This also includes transcribing verbatum from handwritten on-paper solutions to first-draft latex code.
It was also used to check answers before submission.

\end{document}